<!-- [AUTOGENERATED GA-DEPLOY] Deployment Readiness Report -->
# Deployment Readiness Report — Agente Hotelero IA

Fecha: 2025-11-08  
Versión Evaluada: main@HEAD  
Owner: Backend AI Team  

## Resumen Ejecutivo
- Estado: LISTO PARA STAGING (GO)  
- Readiness Score (preflight): 7.0/10 (decisión GO por riesgo global bajo)  
- Riesgo Global: Bajo (risk_score=30.0, umbral GO<50)  
- Cobertura Tests: 31% global, 28 tests pasando en suite relevante.  
- CVEs Críticos: 0 (python-jose 3.5.0)  

## Hallazgos Clave
1. Métricas de seguridad implementadas y activas:
   - `jwt_sessions_active` (Gauge)
   - `db_connections_active` (Gauge)
   - `password_rotations_total{result}` (Counter)
   - `db_statement_timeouts_total` (Counter)
2. Tareas en background para actualización de métricas:
   - JWT Sessions cada 60s  
   - DB Connections cada 30s
3. Dashboards de Grafana provisionados ("Supabase Básico").
4. Health/readiness con verificación de DB/Redis, PMS opcional según `PMS_TYPE`.
5. Alertmanager operativo (pendiente configurar receptores en Slack/Email).

## Resultados de Validaciones
- Health Checks: PASS (200 en `/health/live`, `/health/ready` en local/mock)  
- Preflight Script: GO, risk_score=30.0, blocking_issues=[]  
- Tests de Integración relevantes: PASS (métricas seguridad)  
- Linting: PASS (0 errores reportados en último run)  

## Matriz de Riesgos (Top 5)
| Riesgo | Prob. | Impacto | Mitigación |
|--------|-------|---------|------------|
| Falta receptor Alertmanager | Media | Media | Configurar Slack/Email antes de prod |
| Cobertura de tests baja | Media | Media | Fase 3: subir a 55%+ (orchestrator/pms_adapter) |
| Carga PMS real (perfil pms) | Baja | Alta | Canary en staging con límites y CB |
| Spacy ausente en entornos test | Alta | Baja | Fallback NLP ya activo, aislar import en tests |
| TTL sesiones JWT | Baja | Media | Validar valores en settings y monitorizar métricas |

## Requisitos para Staging
1. Generar `.env.staging` con secretos reales (sin `change-me`).
2. Levantar stack con perfil PMS si se desea validar integración real: `--profile pms`.
3. Ejecutar smoke tests y validar paneles de Grafana.
4. Registrar evidencia con `STAGING-PREDEPLOY-CHECKLIST.md` completado.

## Requisitos Previos a Producción
1. Configurar receptores de Alertmanager (Slack/Email).  
2. Aumentar cobertura de tests al menos al 55% global (85% en críticos).  
3. Ejecutar canary diff y asegurar P95 latency <= +10% vs baseline.  
4. Ensayar rollback (tag previo + compose).  

## Indicadores de Éxito en Staging
- `/ready` estable (3 checks consecutivos 200).  
- Error rate < 2% (promedio 5m).  
- P95 < 800ms.  
- `pms_circuit_breaker_state == 0` (cerrado).  
- Cero alertas críticas en 30m post-deploy.  

## Anexos
- Dashboard JSON: `docker/grafana/dashboards/supabase-basico.json`  
- Compose: `docker-compose.staging.yml`  
- Preflight script: `scripts/preflight.py`  
