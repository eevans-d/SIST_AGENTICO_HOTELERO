# ============================================================================
# Railway Environment Configuration Template
# ============================================================================
# INSTRUCCIONES:
# 1. Copia este archivo a .env.railway.local (NO commitear)
# 2. Reemplaza todos los valores <GENERAR_*> con valores reales
# 3. Usa: railway variables set --file .env.railway.local
# ============================================================================

# ============================================================================
# APPLICATION CORE
# ============================================================================
ENVIRONMENT=production
DEBUG=false
LOG_LEVEL=INFO

# ============================================================================
# SECURITY (GENERAR VALORES ÚNICOS)
# ============================================================================
# Generar con: openssl rand -base64 32
JWT_SECRET=<GENERAR_CON_openssl_rand_-base64_32>
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=60
JWT_REFRESH_TOKEN_EXPIRE_MINUTES=10080

# Generar con: openssl rand -base64 32
JWT_REFRESH_SECRET=<GENERAR_CON_openssl_rand_-base64_32>

# Generar con: openssl rand -base64 32
ENCRYPTION_KEY=<GENERAR_CON_openssl_rand_-base64_32>

# ============================================================================
# DATABASE (Railway inyecta automáticamente DATABASE_URL)
# ============================================================================
# Railway proporciona automáticamente:
# DATABASE_URL=${{ POSTGRES.DATABASE_URL }}
#
# Si necesitas configuración manual:
# POSTGRES_HOST=${{ POSTGRES.RAILWAY_PRIVATE_DOMAIN }}
# POSTGRES_PORT=5432
# POSTGRES_DB=railway
# POSTGRES_USER=postgres
# POSTGRES_PASSWORD=${{ POSTGRES.POSTGRES_PASSWORD }}

# Connection pool settings
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=10
DATABASE_POOL_TIMEOUT=30
DATABASE_POOL_RECYCLE=3600

# ============================================================================
# REDIS (Agregar servicio Redis en Railway primero)
# ============================================================================
# Railway inyecta automáticamente:
# REDIS_URL=${{ REDIS.REDIS_URL }}
#
# O configuración manual:
# REDIS_HOST=${{ REDIS.RAILWAY_PRIVATE_DOMAIN }}
# REDIS_PORT=6379
# REDIS_DB=0
# REDIS_PASSWORD=${{ REDIS.REDIS_PASSWORD }}

# ============================================================================
# RATE LIMITING
# ============================================================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_MAX_REQUESTS=120
RATE_LIMIT_WINDOW_SECONDS=60
RATE_LIMIT_STORAGE_URL=memory://

# Si usas Redis para rate limiting:
# RATE_LIMIT_STORAGE_URL=${{ REDIS.REDIS_URL }}

# ============================================================================
# PMS ADAPTER
# ============================================================================
# Modo mock para desarrollo/testing
PMS_TYPE=mock
PMS_BASE_URL=http://localhost:8080
PMS_TIMEOUT=30
PMS_HOTEL_ID=1

# Modo real (descomentar cuando QloApps esté listo):
# PMS_TYPE=qloapps
# PMS_BASE_URL=https://tu-qloapps-instance.com
# PMS_API_KEY=<TU_QLOAPPS_API_KEY>
# PMS_HOTEL_ID=1

# Circuit breaker settings
PMS_CIRCUIT_BREAKER_ENABLED=true
PMS_CIRCUIT_BREAKER_FAILURE_THRESHOLD=5
PMS_CIRCUIT_BREAKER_RECOVERY_TIMEOUT=30
PMS_CIRCUIT_BREAKER_EXPECTED_EXCEPTION=httpx.HTTPError

# Cache settings
PMS_CACHE_ENABLED=true
PMS_CACHE_TTL_AVAILABILITY=300
PMS_CACHE_TTL_ROOMS=3600
PMS_CACHE_TTL_RESERVATIONS=600

# ============================================================================
# WHATSAPP META CLOUD API (Opcional)
# ============================================================================
# Obtener en: https://developers.facebook.com/apps/
WHATSAPP_ENABLED=false
WHATSAPP_ACCESS_TOKEN=<TU_WHATSAPP_ACCESS_TOKEN>
WHATSAPP_PHONE_NUMBER_ID=<TU_PHONE_NUMBER_ID>
WHATSAPP_API_VERSION=v21.0

# Generar con: openssl rand -hex 16
WHATSAPP_WEBHOOK_VERIFY_TOKEN=<GENERAR_CON_openssl_rand_-hex_16>

# WhatsApp rate limits
WHATSAPP_RATE_LIMIT_ENABLED=true
WHATSAPP_MAX_MESSAGES_PER_SECOND=80
WHATSAPP_MAX_MESSAGES_PER_DAY=100000

# ============================================================================
# GMAIL INTEGRATION (Opcional)
# ============================================================================
# Obtener en: https://myaccount.google.com/apppasswords
GMAIL_ENABLED=false
GMAIL_APP_PASSWORD=<TU_GMAIL_APP_PASSWORD>
GMAIL_FROM_EMAIL=<TU_EMAIL@gmail.com>
GMAIL_FROM_NAME=Agente Hotelero IA

# ============================================================================
# AUDIO PROCESSING (Opcional - Requiere recursos adicionales)
# ============================================================================
AUDIO_PROCESSOR_ENABLED=false
TTS_ENGINE=espeak
STT_ENGINE=whisper
AUDIO_MAX_DURATION_SECONDS=300
AUDIO_SAMPLE_RATE=16000

# ============================================================================
# NLP ENGINE
# ============================================================================
NLP_CONFIDENCE_THRESHOLD=0.6
NLP_FALLBACK_ENABLED=true
NLP_MAX_RETRIES=3

# ============================================================================
# FEATURE FLAGS
# ============================================================================
FEATURE_ORCHESTRATOR_ENABLED=true
FEATURE_AUDIO_PROCESSOR_ENABLED=false
FEATURE_GMAIL_NOTIFICATIONS_ENABLED=false
FEATURE_WHATSAPP_ENABLED=false
FEATURE_PMS_CIRCUIT_BREAKER_ENABLED=true
FEATURE_TENANCY_DYNAMIC_ENABLED=true

# ============================================================================
# MONITORING & OBSERVABILITY
# ============================================================================
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090
JAEGER_ENABLED=false
GRAFANA_ENABLED=false

# Health checks
CHECK_PMS_IN_READINESS=false
HEALTHCHECK_TIMEOUT_SECONDS=30

# ============================================================================
# UVICORN SERVER (Railway usa $PORT dinámico)
# ============================================================================
# Railway inyecta PORT automáticamente, NO configurar aquí
# PORT=${{ PORT }}

UVICORN_WORKERS=4
UVICORN_MAX_WORKERS=8
UVICORN_TIMEOUT_KEEP_ALIVE=65
UVICORN_LOG_LEVEL=info

# ============================================================================
# SESSION MANAGEMENT
# ============================================================================
SESSION_TTL_SECONDS=86400
SESSION_MAX_IDLE_SECONDS=3600
SESSION_CLEANUP_INTERVAL_SECONDS=3600

# ============================================================================
# LOCK SERVICE
# ============================================================================
LOCK_DEFAULT_TIMEOUT_SECONDS=30
LOCK_MAX_TIMEOUT_SECONDS=300
LOCK_CLEANUP_INTERVAL_SECONDS=60

# ============================================================================
# TENANCY
# ============================================================================
TENANCY_DYNAMIC_ENABLED=true
TENANCY_CACHE_TTL_SECONDS=300
TENANCY_DEFAULT_TENANT_ID=default

# ============================================================================
# CORS (Configurar según dominios permitidos)
# ============================================================================
CORS_ENABLED=true
CORS_ALLOW_ORIGINS=["https://tu-dominio.com","https://tu-frontend.vercel.app"]
CORS_ALLOW_METHODS=["GET","POST","PUT","DELETE","OPTIONS"]
CORS_ALLOW_HEADERS=["*"]
CORS_ALLOW_CREDENTIALS=true

# ============================================================================
# NOTAS IMPORTANTES
# ============================================================================
# 1. Railway inyecta automáticamente:
#    - PORT (puerto dinámico del servicio)
#    - DATABASE_URL (si agregaste PostgreSQL)
#    - REDIS_URL (si agregaste Redis)
#
# 2. Variables con ${{ SERVICE.VAR }} son referencias de Railway
#    Se configuran en el dashboard, NO en este archivo
#
# 3. Generar secretos ANTES de deployment:
#    - JWT_SECRET: openssl rand -base64 32
#    - JWT_REFRESH_SECRET: openssl rand -base64 32
#    - ENCRYPTION_KEY: openssl rand -base64 32
#    - WHATSAPP_WEBHOOK_VERIFY_TOKEN: openssl rand -hex 16
#
# 4. Este archivo es un TEMPLATE, crear .env.railway.local con valores reales
#
# 5. NUNCA commitear .env.railway.local a git (agregado a .gitignore)
